<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory · Muscade.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Muscade.jl logo"/></a><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Purpose</a></li><li class="is-active"><a class="tocitem" href="Theory.html">Theory</a><ul class="internal"><li><a class="tocitem" href="#Classes-of-degrees-of-freedom"><span>Classes of degrees of freedom</span></a></li><li><a class="tocitem" href="#Target-function"><span>Target function</span></a></li><li><a class="tocitem" href="#Lagrangian"><span>Lagrangian</span></a></li><li><a class="tocitem" href="#Elements"><span>Elements</span></a></li><li><a class="tocitem" href="#Solvers"><span>Solvers</span></a></li></ul></li><li><a class="tocitem" href="Modelling.html">Creating a model</a></li><li><a class="tocitem" href="Elements.html">Creating an element</a></li><li><a class="tocitem" href="Solvers.html">Creating a solver</a></li><li><a class="tocitem" href="Builtin_els.html">Built-in elements</a></li><li><a class="tocitem" href="Builtin_sol.html">Built-in solvers</a></li><li><a class="tocitem" href="TypeStable.html">Type-stability</a></li><li><a class="tocitem" href="Memory.html">Memory management</a></li><li><a class="tocitem" href="Adiff.html">Automatic differentiation</a></li><li><a class="tocitem" href="reference.html">Reference manual</a></li><li><a class="tocitem" href="LICENSE.html">MIT License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="Theory.html">Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="Theory.html">Theory</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SINTEF/Muscade.jl/blob/master/docs/src/Theory.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h1><h2 id="Classes-of-degrees-of-freedom"><a class="docs-heading-anchor" href="#Classes-of-degrees-of-freedom">Classes of degrees of freedom</a><a id="Classes-of-degrees-of-freedom-1"></a><a class="docs-heading-anchor-permalink" href="#Classes-of-degrees-of-freedom" title="Permalink"></a></h2><p><code>Muscade</code> introduces 3 <em>classes</em> of degrees of freedom (dofs). </p><p><strong>Xdofs</strong> are the dofs normaly encountered in normal &quot;forward&quot; FEM analysis.  They provide a discrete representation of the response of the system. There is a one-to-one relation (a &quot;duality&quot;) between the Xdofs <span>$X$</span> and the <em>residuals</em> <span>$R$</span>, which are the discretized form of he differential equations we seek to solve. In forward FEM, we seek to solve a problem of the form</p><p class="math-container">\[\forall t, R(X(t),t)=0\]</p><p><strong>Udofs</strong> are additional dofs that can be used to represent additional loads on the system. Like Xdofs, Udofs are time-dependant. Unlike Xdofs, there str no residuald (no new equations) corresponding to them.</p><p><strong>Adofs</strong> are additional dofs that can be used to parameterise the model. Adofs are <em>not</em> time-dependant,and there are no residuals corresponing to them.</p><p>Equilibrium now requires</p><p class="math-container">\[\forall t, R(X(t),U(t),A,t)=0\]</p><p>which is ill-posed (unknowns <span>$U$</span> and <span>$A$</span> have been added, but there are no new equations).</p><p>To simplify the presentations in the following, we drop time <span>$t$</span> from the notations.  This can be interpreted in two ways:</p><ol><li>We are looking at a problem at a single instant (static).</li><li>We are solving an evolution problem (dynamic), and <span>$X$</span> and <span>$U$</span> are now vectors-valued functions of time, and <span>$R$</span>represents a vector of ordinary differential equations (over time). </li></ol><h2 id="Target-function"><a class="docs-heading-anchor" href="#Target-function">Target function</a><a id="Target-function-1"></a><a class="docs-heading-anchor-permalink" href="#Target-function" title="Permalink"></a></h2><p>To make the problem well-posed again, we introduce a target function <span>$Q(X,U,A)$</span>.  We then seek to make <span>$Q$</span> extremal (finding a local minimum, maximum), under the constraint <span>$R(X,U,A)=0$</span>. Depending on the relevant application, <span>$Q$</span> can represent different concepts.</p><p>In design optimisation, one can associate a monetary value to <span>$A$</span> (building stronger costs more money), and to <span>$X$</span> (some system responses, including failure, would cost money). The objective is to find the design with the lowest associated cost.</p><p>In an load estimation problem where part of the response is measured, we wish to find the most probable unknown load <span>$U$</span> (large loads are not likely) and response (a computed response <span>$X$</span> that drasticaly disagrees with the actual measurements is not likely) - under the constraint that load and response verify equilibrium.  In this case, we minimize the <em>surprisal</em> <span>$s = -\log(P)$</span> instead of maximizing <span>$P$</span>.  Making probabilities or surprisal extremal is equivalent.   However, since probabilities multiply (the joint probability density of independant variables is equal to the product of the marginal probability densities), the corresponding surprisals add, which fits into the system of having elements <em>add</em> contribution to the system of equations to be solved. Further, the surprisals are typicaly numericaly &quot;kinder&quot;.</p><h2 id="Lagrangian"><a class="docs-heading-anchor" href="#Lagrangian">Lagrangian</a><a id="Lagrangian-1"></a><a class="docs-heading-anchor-permalink" href="#Lagrangian" title="Permalink"></a></h2><p>Making <span>$Q$</span> extremal under the constraint <span>$R(X,U,A)=0$</span> is equivalent to finding an extremal (a saddle point) of the <em>Lagrangian</em> <span>$L(\Lambda,X,U,A)$</span> (not to be confused with the potential in Lagrangian mechanics)</p><p class="math-container">\[L(\Lambda,X,U,A) = Q(X,U,A) + R(X,U,A) \cdot \Lambda\]</p><p>where <span>$Λ$</span> are Lagrange multipliers.  There is again a one-to-one correspondance between Λdofs and residuals, and this between Λdofs and Xdofs.  One result of this correspondance is that when implmenting a new element, the method <code>doflist</code> does not list the Λdofs (this would otherwise just have been a compulsory repetition of the list of Xdofs). </p><p>For evolution problems, the dot product <span>$R(X,U,A) \cdot \Lambda$</span> includes an integral over time: the Lagrangian is a <em>functional</em>, and the gradients of <span>$L$</span> are ordinary (or integral) differential equations (in time), found using Frechet derivatives.</p><p>Additional constraints may be introduced. <em>Physical constraints</em> (like contact or boundary conditions) are added by augmenting <span>$X$</span> and <span>$R$</span>.  <em>Optimisation constraints</em> may have to be verified at every step (stresses to remain below a critical level, at any time).  They are handled by augmenting <span>$U$</span> (introducing a Udof Lagrange multiplier).  Optimisation constraints that act only on Adofs (there is a limit to the strength of steel we can order)  are handled by augmenting <span>$A$</span>.  With the additional constraints, the Lagrangian is of the form</p><p class="math-container">\[\begin{aligned}
L(\Lambda,X,U,A) = Q(X,U,A)  &amp;+ \left[\begin{array}{c}R(X,U,A) - ∇g_x(X,U,A) \cdot X_λ \\ g_x(X,U,A)\end{array}\right] \cdot Λ \\ &amp;+ g_u(X,U,A) \cdot U_\lambda \\ &amp;+ g_a(A) \cdot A_\lambda 
\end{aligned}\]</p><h2 id="Elements"><a class="docs-heading-anchor" href="#Elements">Elements</a><a id="Elements-1"></a><a class="docs-heading-anchor-permalink" href="#Elements" title="Permalink"></a></h2><p>In the original finite element analysis, the <em>elements</em> in a model form a partition of a domain over which differential equations are to be solved. We will call these &quot;physical elements&quot;.  These elements provide additive contributions to the system of equations <span>$R(X,U,A)=0$</span>. Further contributions can come from external loads.</p><p>When doing optimization-FEM in <code>Muscade</code>, the elements provide additive contributions to the Lagrangian scalar <span>$L$</span>, instead of to the residual vector <span>$R$</span>. Actualy when creating a new element in <code>Muscade</code> to create an application, one can either implement a contribution to <span>$R$</span> by implementing a method <code>Muscade.residual</code> for the element, or a contribution to <span>$L$</span> by implementing <code>Muscade.lagrangian</code>.  For performance, whenever possible (for example when implementing a physical element), prefer <code>Muscade.residual</code>. </p><p>In <code>Muscade</code>, the broad view is taken that anything that contributes to <span>$L$</span> is an element (even if no part of the domain is actualy associated to the element).  This more general definition of &quot;elements&quot; includes a variety of types:</p><ul><li>Physical element, disretizing differential equations over a part of the domain</li><li>Known external loads on the boundary (non-essential boundary conditions)</li><li>Known external loads in the domain</li><li>Constrained dofs (essential boundary conditions)</li><li>Holonomic equality and inequality constraints (contact)</li><li>Optimisation constraints (e.g. stresses shal not exceed some limit at any point within part of the domain)</li><li>Response measurements (surprisal on Xdofs)</li><li>Unknown external loads (surprisal on Udofs)</li><li>Damage (surprisal on Adofs)</li><li>Cost of unfavorable response (cost on Xdofs)</li><li>Cost of actuators (cost on Udofs)</li><li>Cost of building a system (cost on Adofs)</li></ul><p>Because &quot;everything&quot; is an element, app developers can express a wide range of ideas through <code>Muscade</code>&#39;s element API.</p><h2 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h2><p>Solvers in <code>Muscade</code> solve problems of different forms including forward <code>X</code> problems</p><p class="math-container">\[R(X,0,0)=0\]</p><p>optimisation <code>XUA</code> problems</p><p class="math-container">\[\begin{aligned}
\nabla_\Lambda L(\Lambda,X,U,A) &amp;= 0 \\
\nabla_X       L(\Lambda,X,U,A) &amp;= 0 \\
\nabla_U       L(\Lambda,X,U,A) &amp;= 0 \\
\nabla_A       L(\Lambda,X,U,A) &amp;= 0
\end{aligned}\]</p><p>as well as corresponding <code>XU</code> and <code>XA</code> problems.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Purpose</a><a class="docs-footer-nextpage" href="Modelling.html">Creating a model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 18 July 2023 11:43">Tuesday 18 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
